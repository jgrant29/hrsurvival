
<div class="container-fluid">
  <div class="row">
    <div class="col-md-12 book-show text-center">
    <h1 class="book-title book-show text-center"><%= @book.title %></h1><hr>
    <div class="author-avatar book-show text-center">
      <%= image_tag(@book.avatar.url) %>
      <div class="written-by">authored by</div>
      <div class="author-name"><%= link_to @book.author, @book.websiteurl %></div>
    <div class="social-media-links">
      <% if @book.facebook? %>
        <%= link_to @book.facebook do %>
          <%= fa_icon "facebook-official 2x"%>
        <% end %>
      <% end %>

      <% if @book.twitter? %>
        <%= link_to @book.twitter do %>
          <%= fa_icon "twitter-square 2x"%>
        <% end %>
      <% end %>

      <% if @book.youtube? %>
        <%= link_to @book.youtube do %>
          <%= fa_icon "youtube-square 2x" %>
        <% end %>
      <% end %>
      <% if @book.tumblr? %>
        <%= link_to @book.tumblr do %>
          <%= fa_icon "tumblr-square 2x" %>
        <% end %>
      <% end %>
      <% if @book.linkedin? %>
        <%= link_to @book.linkedin do %>
          <%= fa_icon "linkedin-square 2x" %>
        <% end %>
      <% end %>
    </div>
    <% if policy(@book).update? %>
      <%= link_to "Edit Book", edit_book_path(@book), class: 'btn btn-primary' %>
      <%= link_to "New Chapter", new_book_chapter_path(@book), class: 'btn btn-primary' %>
    <% end %>
    </div><hr>
    <% @book.chapters.each do |chapter| %>
      <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default">
          <div class="panel-heading book-show" role="tab" id="headingOne">
            <div class="panel-title panel-book-title">
              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#<%= chapter.id %>" aria-expanded="false" aria-controls="<%= chapter.id %>">
                  <h2><%= chapter.title %></h2>
                  <span class="glyphicon glyphicon-plus"></span>
                </a>
              </div>
              <% if policy(@book).update? %>
                <%= link_to "Edit Chapter", edit_book_chapter_path(@book, chapter), class: "edit" %> | <%= link_to "New TOC", new_book_chapter_tableofcontent_path(@book, chapter), class: "edit" %>
            <% end %>   
            </div>
          <div id="<%= chapter.id %>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
            <div class="panel-body">
              <% chapter.tableofcontents.each do |toc| %>
            <h3 class="toc-title-panel"> 
              <%= link_to toc.title, book_chapter_tableofcontent_path(@book, chapter, toc) %></h3><hr>
            <% end %>
            </div>
          </div>
        </div>
      </div>
        <% end %>
      </div>
  </div>
    <div class="col-md-9">
       <div class="google-adsense pull-right">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- hrsurvival v2 -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-2109246747658646"
             data-ad-slot="3005377619"
             data-ad-format="auto"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>


  </div>
</div>
</div>
  <%= render partial: 'footer/footer' %>



<script>
  $(document).ready(function(){
    // set params to equal a Decoded URI Component (decodeURICompent is a javascript 
    // function used to decode URIs with special characters i.e. ? / % & and so forth)
    // window.location.search brings you the entire URI up to the search "?" part of the component
    // (1) brings you to the next element after the search "?".
    // .spit is a jquery method that splits the URI before and after the equal sign
    params = decodeURIComponent(window.location.search.substring(1)).split("=")

    // below we ask if the first param is equal to "chapter_title" (we set this path in the collapse method in bootstrap's, javascript collapse method in the latter part of the tableofcontent show.html.erb)
    if(params[0] == "chapter_title"){
      // if params equals chapter_title we then paste the current path to the decodeURIComponent within javascript's collapse method
      // then we ask the function to use jquery's show method on the collapse method
      $("#" + params[1] ).collapse('show');
    }
  })
</script>